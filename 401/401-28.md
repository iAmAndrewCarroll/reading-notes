# Readings: Django CRUD and Forms

**1. How do Django Forms facilitate user input handling, and what are some key components of creating a form using the Django framework?**

Django Forms facilitate user input handling by providing an abstraction to define HTML forms using Python code. Key components of creating a form in Django include:

- Defining a form class (derived from `forms.Form` or `forms.ModelForm`).
- Specifying form fields and their validation rules using Django's built-in form fields (e.g., `CharField`, `IntegerField`, etc.).
- Rendering the form in templates using Django's template language (e.g., `{{ form.as_p }}`) and including `{% csrf_token %}` for security.

**2. Explain the purpose of Django Templates in web development and describe how template inheritance can be utilized to improve code reusability and maintainability.**

Django Templates serve as the presentation layer in web development. They allow the dynamic rendering of HTML pages with data from Django's views. Template inheritance enhances code reusability and maintainability by allowing developers to:

- Define a base template containing common elements (e.g., header, footer) and placeholders for content (e.g., `{% block content %}`).
- Create child templates that extend the base template using `{% extends 'base.html' %}` and filling in the placeholders with specific content using `{% block content %}`.

**3. Describe the function of Django Views in handling HTTP requests, and outline the differences between function-based views and class-based views.**

Django Views handle HTTP requests and return HTTP responses. They contain the business logic for processing user requests and preparing data for rendering templates. 

- **Function-based views**: Defined as Python functions. Straightforward and suitable for simple views.
- **Class-based views**: Offer more modularity and functionality through inheritance and mixins, making complex views more manageable. They allow defining view logic as class methods (e.g., `get()`, `post()`) and provide reusable behavior through mixins.

# Warm Up

def score_word(word):
  <!-- EXTRA: check if word empty -->
  if not word:
    return 0
  <!-- DONE: set initial total -->
  score = 0
  <!-- DONE: loop through word -->
  for letter in word:
  <!-- EXTRA: check if it is alpha character for additional check -->
    if letter.isalpha():
  <!-- DONE: add POINTS value to total -->
    score += POINTS[letter]
  <!-- DONE: return total -->
  return score

if __name__ == '__main__':
  print(score_word('cabbage')) 
  print(score_word('za'))
  print(score_word('blah'))

# in Django App Notes
- delete everything in the migration folder except the dunder init
- then run python manage.py makemigrations

# Another Follow Along

### CLI

1. take movie-tracker
2. vi (venv)
3. va (activate)
4. pip install
5. pip freeze > requirements.txt
5. pip install django
6. django-admin startproject movies_project .
7. tree
8. pmp startapp movie
9. mkdir templates
10. touch templates/movie-list.html
11. touch templates/base.html
12. mkdir static (for css later on)
13. touch movie/urls.py
14. touch static/base.css

### VS Code

15. I missed some things

18. Maybe... add movies to "INSTALLED_APPS = ["
19. Add the [BASE_DIR / 'templates']
    to the TEMPLATES = inside settings.py
    * BASE_DIR = Path(--file--).resolve().parent.parent

20. CLI - touch movies_project/.env
21. **pip install django environ**
22. pipf (adds it to req.txt file)

23. In movies_project/settings.py **import environ** 
    * add **env = environ.Env(
      SECRET_KEY='django-insecure-gobbledygooc",
    )
24. #Read Env
    * environ.Env.read_env()

25. inside .env (44 minute timestamp)
    * SECRET_KEY=django-insecure-blahblahblah
    * **Notice this one has no quotes""**

26. inside movie_project/settings.py
    * SECRET_KEY = env.str('SECRET_KEY') reads from the .env

27. test server: pmp runserver
    * Roger got an 'env' is not defined error
    * the env = environ.Env was commented out
28. by commenting out SECRET_KEY you can check if it is functioning properly

29. Inside settings.py: env = environ.Env(
  DEBUG=(bool, False),
)

30. Move DEBUG = True into .env with SECRET_KEY
    * in settings.py change DEBUG = env.bool('DEBUG')

31. Remember to make an env.txt to push to github

32. movie/migrations/models.py
    * from django.db import models
    * from django.contrib.auth import get_user_model
    * class Movie(models.Model):
        name = models.CharField(max_length=64)
        description = models.TextField(default='generic description')
        owner = models.ForeignKey(get_user_model(), on_delete=models.CASCADE)

    * def __str__(self):
        return self.name
33. movie/migrations/admin.py
    * from django.contrib import admin
    * from .models import Movie

    * admin.site.register(Movie)

34. pmp makemigrations
35. pmp migrate
36. pmp createsuperuser
    * go through the prompts
    * pmp runserver
    * go to /admin url
    * login and create movies or whatever todays lab is about

CLI
37. touch templates/movie-create.html
38. touch templates/movie-delete.html
39. touch templates/movie-detail.html
40. touch templates/movie-update.html

41. base.html
    * <!DOCTYPE html>
      <head>
        <title>My Movies</title>
      </head>
      <body>
        <header>

        </header>
        <main>
          {% block content %}
            <h2>Someone Forgot To Put Content</h2>
          {% endblock content %}
        </main>
        <footer>
        </footer>
      </body>

42. movie-list.html
    * {% extends 'base.html' %}
      {% block content %}
      <h1>Movie List</h1>
        {% for movie in object_list %}
          <p><a href="{% url 'detail_view' movie.pk %}">{{ movie.name }}</a></p>
        {% endfor %}
      {% endblock content %}

43. views.html
      from django.views.generic import LIstView
      from .models import Movie

      class MovieListView(ListView):
        template_name = 'movie-list.html'
        model = Movie

44. movies_project/urls.py
      from django.contrib import admin
      from django.urls import path, include

      urlpatterns = [
        path('admin/', admin.site.urls),
        path('movies/', include('movie.urls'))
      ]
  
45. migrations/urls.py
      from django.urls import path
      from .views import MovieListView, MovieDetailView

      urlpatterns =[
        path('list', MovieListView.as_view(), name='list_view'),
        path('<int:pk>', MovieDetailView.as_view(), name='detail-view')
      ]

**NOTE: We still have not defined our home route**

46. views.py
      from & import 
      class MovieListView(ListView):
        template_name = 'movie-list.html'
        model = Movie
        context_object_name = 'movies'

      class MovieDetailView(DetailView):
        template_name = 'movie-detail.html
        model = Movie

47. movie-detail.html
      {% extends 'base.html' %}

      {% block content %}
        <h1>Movie: {{ movie.name }}</h1>
        <p>Description: {{ move.description }}</p>
        <p>Owner: {{ movie.owner }}
      {% endblock content %}

# Starting Create, Read, Update, Delete (CRUD)

48. views.py
      from django.views.generic import ListView, DetailView, CreateView
    **new addition**
      class MovieCreateView(CreateView):
        template_name = 'movie-create.html'
        model = Movie
        fields = ['name', 'description', 'owner']

49. urls.py
      **new path**
       from .view > MovieCreateView
       path('new', MovieCreateView.as_view(), name='create_view')

50. movie-create.html
    {% extends 'base.html' %}
    
    {% block content %}
      <h1>Create a Movie</h1>
      <form action="" method="POST">
        <!-- this is called cross site r forgery. a prevention measure -->
        {% csrf_token %}
        {{ form.as_p }}
        <input type="submit" value="SAVE">
      </form>
    {% endblock content %}
    **to get to this page roger went to 8000/movies/new**

51. models.py
      **New from django.urls import reverse**
      **New function under def --str--**
        def get_absolute_url(self):
          return reverse('detail_view', args=[str(self.id)])

52. urls.py
      **new import MovieUpdateView**
      path('<pk:int>/edit', MovieUpdateView.as_view(), name='update_view')

53. views.py
      new import UpdateView
      class MovieUpdateView(UpdateView):
        template_name = 'movie_update.html'
        model = Movie
        fields = ['name', 'description', 'owner']

54. movie-update.html
    {% extend 'base.html' %}

    {% block content %}
      <h1>Update Movie</h1>
      <form action="" method="POST">
      {% csrf_toke %}
      {{ form.as_p }}
      <input type="submit" value="SAVE">]
    {% endblock content %}

55. urls.py
    path('<int:pk>/edit', MovieUpdateView.as_view(), name='update_view'),

56. view.py
    new import DeleteView
    new from django.urls import reverse_lazy
    **when we delete a movie we need to send it to a custom update view; we will send it to the movie list**
    class MovieDeleteView(DeleteView):
      template_name = 'movie-delete.html'
      model = Movie
      success_url = reverse_lazy('list_view')

57. movie_delete.html
    {% extends 'base.html' %}

    {% block content %}
      <h1>Delete Movie</h1>
      <form action="" method="POST">
      {% csrf_toke %}
      {{ form.as_p }}
        <p>Do you REALLY want to delete {{ movie.name }}</p>
      <input type="submit" value="OK">] 
    {% endblock content %}

58. urls.py
    path('<int:pk>/delete', MovieDeleteView.as_view(), name='delete_view'),
**the database id of 3 (in the case of the deleted 3rd item from todays demo) is done being used forever once you delete it from the list/db**

59. base.html
        * <!DOCTYPE html>
      <head>
        <title>My Movies</title>
      </head>
      <body>
        <header>
          <a href="{% url 'create_view' %}">+ New Movie</a>
          <a href="{% url 'list_view' %}">List of Movies</a>
        </header>
        <main>
          {% block content %}
            <h2>Someone Forgot To Put Content</h2>
          {% endblock content %}
        </main>
        <footer>
        </footer>
      </body> 

60. movie_detail.html
    {% extends 'base.html' %}

    {% block content %}
      <h1>Movie: {{ movie.name }}</h1>
      <p>Description: {{ movie.description }}</p>
      <p>Owner: {{ movie.owner }}</p>
      <p><a href="{% url 'update_view' %}">+ New Movie</a></p>
      <p><a href="{% url 'delete_view' %}">List of Movies</a></p>

    {% endblock content %}

61. static folder moved into templates folder
    **inside settings.py**
    under STATIC_URL = 'static/'
    STATICFILES_DIRS = [BASE_DIR / 'static']
    **inside base.html**
    {% load static %}
    under title
    <link rel="stylesheet" href="{% static 'base.css' %}">
    
    **inside static/base.css**
      static contains base.css
        within base.css
          body {
            background-color: bisque;
          }

